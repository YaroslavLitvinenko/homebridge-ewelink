{
  "pluginAlias": "eWeLink",
  "pluginType": "platform",
  "singular": true,
  "customUi": true,
  "customUiPath": "./lib/homebridge-ui",
  "headerDisplay": "<p align=\"center\"><img width=\"60%\" src=\"https://user-images.githubusercontent.com/43026681/101325266-63126600-3863-11eb-9382-4a2924f0e540.png\"></p><p align=\"center\">For help and support please visit our <a href=\"https://github.com/bwp91/homebridge-ewelink/wiki\">GitHub Wiki</a>. We hope you find this plugin useful!</p>",
  "schema": {
    "type": "object",
    "properties": {
      "name": {
        "type": "string",
        "default": "eWeLink"
      },
      "countryCode": {
        "type": "number",
        "title": "Country Code",
        "placeholder": "Enter without the +",
        "required": true
      },
      "username": {
        "type": "string",
        "title": "Username",
        "required": true,
        "placeholder": "Email or full phone (e.g. +8613185260282)"
      },
      "password": {
        "type": "string",
        "title": "Password",
        "required": true
      },
      "mode": {
        "type": "string",
        "title": "Connection Mode",
        "description": "This setting defines how the plugin communicates with your devices.",
        "default": "auto",
        "oneOf": [
          {
            "title": "Auto (Recommended)",
            "enum": [
              "auto"
            ]
          },
          {
            "title": "Cloud Only",
            "enum": [
              "wan"
            ]
          },
          {
            "title": "LAN Only",
            "enum": [
              "lan"
            ]
          }
        ]
      },
      "disableDeviceLogging": {
        "type": "boolean",
        "title": "Disable Device Logging",
        "description": "If checked, device updates will not be added to the log."
      },
      "debug": {
        "title": "Debug Logging",
        "type": "boolean",
        "description": "If checked, debug information will be added to the log."
      },
      "disablePlugin": {
        "title": "Disable Plugin",
        "type": "boolean",
        "description": "If checked, the plugin will remove all accessories and not load the plugin on restart."
      },
      "ignoredDevices": {
        "type": "string",
        "title": "Ignored Devices",
        "description": "A list of devices to ignore by device id. For example 10009553c8 or multiple separated by a comma."
      },
      "hideChanFromHB": {
        "type": "string",
        "title": "Hide Light/Switch Channels",
        "description": "A list of light/switch channels to hide. For example 10009553c8SW0 or multiple separated by a comma."
      },
      "switchAsOutlet": {
        "type": "string",
        "title": "Switch As Outlet",
        "description": "A list of switch devices to show as outlets. For example 10009553c8 or multiple separated by a comma."
      },
      "outletAsSwitch": {
        "type": "string",
        "title": "Outlet As Switch",
        "description": "A list of outlet devices to show as switches. For example 10009553c8 or multiple separated by a comma."
      },
      "inUsePowerThreshold": {
        "type": "number",
        "title": "Outlet 'In Use' Threshold",
        "description": "HomeKit will set the 'In Use' status of outlet devices to true when the wattage is above this number. Must be 0 or more.",
        "placeholder": 0,
        "minimum": 0
      },
      "hideLightFromFan": {
        "type": "string",
        "title": "Hide Fan Lights",
        "description": "A list of iFan devices for which the light will be hidden. For example 10009553c8 or multiple separated by a comma."
      },
      "hideSwitchFromTH": {
        "type": "string",
        "title": "Hide TH10/16 Switches",
        "description": "A list of TH10/TH16 devices for which the switch will be hidden. For example 10009553c8 or multiple separated by a comma."
      },
      "thAsThermostat": {
        "type": "string",
        "title": "TH As Thermostat",
        "description": "A list of TH10/TH16 devices to show as thermostats. For example 10009553c8 or multiple separated by a comma."
      },
      "thTempOffset": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "deviceId": {
              "type": "string"
            },
            "offset": {
              "type": "number"
            }
          }
        }
      },
      "resetRFBridge": {
        "title": "Reset RF Bridges",
        "type": "string",
        "description": "A list of RF Bridges to remove and re-add on restart. This is needed when adding/removed sub-devices from the RF Bridge. For example 10009553c8 or multiple separated by a comma."
      },
      "lowBattThreshold": {
        "type": "number",
        "title": "Low Battery Threshold",
        "description": "HomeKit will set the low battery status for supported devices when the device battery reaches this percentage level. Must be 5 or more.",
        "placeholder": 25,
        "minimum": 5
      },
      "sensorTimeDifference": {
        "type": "number",
        "title": "Sensor Lag",
        "description": "An offset in seconds to ignore any notifications if they is a delay between a sensor detecting something and the plugin receiving the notification. This setting applies to sensors connected to RF/Zigbee Bridges. Must be 10 or more.",
        "placeholder": 120,
        "minimum": 10
      },
      "hideZBLDPress": {
        "title": "Zigbee Button Hide Double/Long Press",
        "type": "boolean",
        "description": "If checked, double and long press options will be hidden for the ZigBee button."
      },
      "ZBDWBatt": {
        "type": "boolean"
      },
      "bulbB02BA60": {
        "type": "string"
      },
      "bulbB02FST64": {
        "type": "string"
      },
      "groups": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "deviceId": {
              "type": "string",
              "title": "Device ID",
              "description": "Device ID from your eWeLink app (ten digits normally in the format 1000ab23cd)."
            },
            "type": {
              "type": "string",
              "title": "Type",
              "description": "The new type for this device.",
              "oneOf": [
                {
                  "title": "1 Garage Door",
                  "enum": [
                    "garage"
                  ]
                },
                {
                  "title": "1 Garage Door (using Eachen GD-DC5)",
                  "enum": [
                    "garage_eachen"
                  ]
                },
                {
                  "title": "2 Garage Doors (using multi-channel device)",
                  "enum": [
                    "garage_two"
                  ]
                },
                {
                  "title": "4 Garage Doors (using multi-channel device)",
                  "enum": [
                    "garage_four"
                  ]
                },
                {
                  "title": "1 Window Blind (using multi-channel device)",
                  "enum": [
                    "blind"
                  ]
                },
                {
                  "title": "1 Lock",
                  "enum": [
                    "lock"
                  ]
                },
                {
                  "title": "1 Tap/Faucet",
                  "enum": [
                    "tap"
                  ]
                },
                {
                  "title": "2 Taps/Faucets (using multi-channel device)",
                  "enum": [
                    "tap_two"
                  ]
                },
                {
                  "title": "1 Irrigation Valve",
                  "enum": [
                    "valve"
                  ]
                },
                {
                  "title": "2 Irrigation Valves (using multi-channel device)",
                  "enum": [
                    "valve_two"
                  ]
                },
                {
                  "title": "4 Irrigation Valves (using multi-channel device)",
                  "enum": [
                    "valve_four"
                  ]
                },
                {
                  "title": "1 Switch & 1 Valve (using multi-channel device)",
                  "enum": [
                    "switch_valve"
                  ]
                }
              ]
            },
            "setup": {
              "type": "string",
              "title": "Device Setup",
              "description": "The type of generic device being used.",
              "condition": {
                "functionBody": "return (model.groups[arrayIndices] && ['garage', 'lock', 'tap', 'valve'].includes(model.groups[arrayIndices].type))"
              },
              "oneOf": [
                {
                  "title": "Single-Channel",
                  "enum": [
                    "oneSwitch"
                  ]
                },
                {
                  "title": "Multi-Channel",
                  "enum": [
                    "twoSwitch"
                  ]
                }
              ]
            },
            "operationTime": {
              "type": "number",
              "title": "Operation Time (Deciseconds)",
              "description": "Blinds/garage doors: the time to open/close the device. Locks: the time to show as unlocked. This setting is in deciseconds - count the time in seconds and multiply by 10, for example 75 for 7.5 seconds. Must be 20 or more.",
              "condition": {
                "functionBody": "return (model.groups[arrayIndices] && ['garage', 'garage_two', 'garage_four', 'garage_eachen', 'blind', 'lock'].includes(model.groups[arrayIndices].type))"
              },
              "placeholder": 100,
              "minimum": 20
            },
            "sensorId": {
              "type": "string",
              "title": "Sensor",
              "description": "A DW2 sensor can be used for a single garage door to determine the current state. Enter the 10 digit eWeLink device ID (normally in the format 1000ab23cd). Otherwise leave blank.",
              "condition": {
                "functionBody": "return (model.groups[arrayIndices] && model.groups[arrayIndices].type==='garage')"
              }
            },
            "obstructId": {
              "type": "string",
              "title": "Obstruction Switch",
              "description": "An optional switch that will trigger the Obstruction Detected feature depending on its value. Otherwise leave blank.",
              "condition": {
                "functionBody": "return (model.groups[arrayIndices] && ['garage', 'garage_eachen'].includes(model.groups[arrayIndices].type))"
              }
            }
          }
        }
      },
      "bridgeSensors": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "fullDeviceId": {
              "type": "string",
              "title": "Sensor Device ID",
              "description": "Device ID of the sensor (13 digits normally in the format 1000ab23cdSW2)."
            },
            "type": {
              "type": "string",
              "title": "Sensor Type",
              "description": "Select the type of sensor you would like to expose this as.",
              "oneOf": [
                {
                  "title": "Motion",
                  "enum": [
                    "motion"
                  ]
                },
                {
                  "title": "Smoke/Fire",
                  "enum": [
                    "smoke"
                  ]
                },
                {
                  "title": "Water/Leak",
                  "enum": [
                    "water"
                  ]
                },
                {
                  "title": "Carbon Monoxide",
                  "enum": [
                    "co"
                  ]
                },
                {
                  "title": "Carbon Dioxide",
                  "enum": [
                    "co2"
                  ]
                },
                {
                  "title": "Occupancy",
                  "enum": [
                    "occupancy"
                  ]
                },
                {
                  "title": "Contact",
                  "enum": [
                    "contact"
                  ]
                }
              ]
            },
            "sensorTimeLength": {
              "type": "number",
              "title": "Sensor Time Length",
              "description": "The number of seconds which the sensor tile in the Home app will light up for if this sensor is activated. Must be 1 or more.",
              "placeholder": 60,
              "minimum": 1
            }
          }
        }
      },
      "nameOverride": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "fullDeviceId": {
              "type": "string"
            },
            "deviceName": {
              "type": "string"
            }
          }
        }
      },
      "ipOverride": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "deviceId": {
              "type": "string"
            },
            "deviceIP": {
              "type": "string"
            }
          }
        }
      }
    }
  },
  "layout": [
    {
      "type": "fieldset",
      "title": "Required Settings",
      "items": [
        "countryCode",
        "username",
        "password"
      ]
    },
    {
      "type": "fieldset",
      "title": "Optional Settings",
      "expandable": true,
      "items": [
        "mode",
        "disableDeviceLogging",
        "debug",
        "disablePlugin"
      ]
    },
    {
      "type": "fieldset",
      "title": "Device Settings",
      "expandable": true,
      "items": [
        "ignoredDevices",
        "hideChanFromHB",
        "switchAsOutlet",
        "outletAsSwitch",
        "inUsePowerThreshold",
        "hideLightFromFan",
        "hideSwitchFromTH",
        "thAsThermostat",
        "resetRFBridge",
        "lowBattThreshold",
        "sensorTimeDifference"
      ]
    },
    {
      "key": "groups",
      "expandable": true,
      "title": "Accessory Simulations",
      "description": "Set up custom simulated accessories generic devices - <a href=\"https://github.com/bwp91/homebridge-ewelink/wiki/Accessory-Simulations\" target=\"_blank\">more info</a>.",
      "add": "Add Another Type",
      "type": "array",
      "items": [
        {
          "type": "fieldset",
          "items": [
            "groups[].deviceId",
            "groups[].type",
            "groups[].setup",
            "groups[].operationTime",
            "groups[].sensorId",
            "groups[].obstructId"
          ]
        }
      ]
    },
    {
      "key": "bridgeSensors",
      "title": "RF Bridge Sensors",
      "description": "Expose different types of sensors linked to your RF Bridge - <a href=\"https://github.com/bwp91/homebridge-ewelink/wiki/How-to-set-up-RF-Bridge-sensors\" target=\"_blank\">more info</a>.",
      "expandable": true,
      "add": "Add Another Sensor",
      "type": "array",
      "items": [
        {
          "type": "fieldset",
          "items": [
            "bridgeSensors[].fullDeviceId",
            "bridgeSensors[].type",
            "bridgeSensors[].sensorTimeLength"
          ]
        }
      ]
    }
  ]
}